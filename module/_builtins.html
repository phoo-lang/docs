<!DOCTYPE html><html><head><title>_builtins :: Phoo docs</title><style>
body{color:#ddd;background:#222;font-family:serif}
h1,h3{color:#b0a}
h2,h4,h5,h6{color:#c40}
code+.dpar{padding-left:10px;display:none;opacity:75%;font-size:75%}
code:hover+.dpar,code:focus+.dpar{display:inline-block}
.shadowed{opacity:50%}
a{color:#00a}
a:visited{color:#098}
details,.admonition{border:2px solid var(--yay);border-radius:5px;--yay:#444}
.warning{--yay:#ba4}.danger,.error{--yay:#f00}.info,.note{--yay:#1af}
</style>
<link rel="icon" href="/P.png" type="image/png" />
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.css" type="text/css" />
<link href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/copy-tex.css" rel="stylesheet" type="text/css" />
<link href="https://phoo-lang.github.io/ext/prism/prism.css" rel="stylesheet" type="text/css" />
<script src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/copy-tex.js"></script>
<script>window.addEventListener('DOMContentLoaded',_=>{renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}]})})</script>
<script src="/ext/prism/prism.js" data-autoloader-path="https://www.jsdelivr.com/prismjs@v1.x/components/"></script>
<script src="/prism-phoo.js"></script>
<script>
Prism.plugins.toolbar.registerButton('run-code', function (env) {
    var pre = env.element.parentNode;
    var lang = Prism.util.getLanguage(pre);
    if (!pre || !/pre/i.test(pre.nodeName) || lang !== 'phoo') {
        return;
    }
    var ctr = btoa(pre.textContent);
    var btn = document.createElement('a');
    btn.setAttribute('href', `/?code=${ctr}`);
    btn.textContent = 'Run this code';
    return btn;
});
</script></head><body><h1 id="use-_builtins"><code>use _builtins</code></h1>
<p>This module is contains the words necessary to implement the builtin functionality of Phoo, that must be
defined in Javascript and not Phoo code for the ease of bootstrapping.</p>
<p>The rest of the built-in words, that <em>are</em> defined in Phoo code, can be found on the page for <a href="builtins.html">builtins</a> (without the underscore).</p>
<h3 id="%2f%2a"><code>/*</code>  (  &rarr;  )</h3>
<p>Block comment. Like C-style comments. Comments do not nest.</p>
<h3 id="%24"><code>$</code>  (  &rarr; <code>s</code><em class="dpar">The string (or regular expression) defined by the literal.</em> )</h3>
<p>String builder.</p>
<p>First non-whitespace character after the <code>$</code> is the delimiter. The delimiter can be escaped by doubling it.</p>
<p>The characters immediately following the end delimiter are known as the &ldquo;tag&rdquo; and affect the resultant string. The first character is the code that determines the formatting applied.</p>
<p>Currently the only one implemented is <code>r</code>, which turns the string into a regular expression. The characters after the <code>r</code> are the flags that would go at the end of it. There is no way to &ldquo;escape&rdquo; any characters other than the delimiter, but a <code>e</code> code for defining an escape character is planned. See issue <a href="https://github.com/dragoncoder047/phoo/issues/8">#8</a> for the status of that.</p>
<p>Example:</p>
<pre><code class="language-phoo">
$ 5ab*c?5rig
// puts the regular expression /ab*c?/ig.
</code></pre>
<h3 id="do"><code>do</code>  (  &rarr;  )</h3>
<p>Starts of a new sub-array.</p>
<h3 id="%5b"><code>[</code>  (  &rarr;  )</h3>
<p>Same as <code>do</code>.</p>
<h3 id="end"><code>end</code>  (  &rarr;  )</h3>
<p>End of a sub-array.</p>
<h3 id="%5d"><code>]</code>  (  &rarr;  )</h3>
<p>Same as <code>end</code>.</p>
<h3 id="pick"><code>pick</code>  ( <code>n</code><em class="dpar">Depth of item to pick</em> &rarr; <code>i</code><em class="dpar">COPY of the item.</em> )</h3>
<p>Same as the Forth word <code>PICK</code>. Takes a number <code>n</code> and <strong>copies</strong> the nth item to the top.</p>
<p><strong>See Also:</strong> <a href="#roll"><code>roll</code></a></p>
<h3 id="roll"><code>roll</code>  ( <code>n</code><em class="dpar">Depth of item to pick</em> &rarr; <code>i</code><em class="dpar">COPY of the item.</em> )</h3>
<p>Same as the Forth word <code>ROLL</code>. Takes a number <code>n</code> and <strong>moves</strong> the nth item to the top .</p>
<p><strong>See Also:</strong> <a href="#pick"><code>pick</code></a></p>
<h3 id="drop"><code>drop</code>  ( <code>n</code> &rarr;  )</h3>
<p>Removes the top item from the stack.</p>
<h3 id="1%2b"><code>1+</code>  ( <code>n</code> &rarr; <code>n+1</code> )</h3>
<p>Increments a number on the top of the stack.</p>
<h3 id="1%2d"><code>1-</code>  ( <code>n</code> &rarr; <code>n-1</code> )</h3>
<p>Decrements a number on the top of the stack.</p>
<h3 id="%2b"><code>+</code>  ( <code>a</code> <code>b</code> &rarr; <code>b+a</code> )</h3>
<p>Adds two items together using Javascript <code>+</code> operator. Note the order of addition.</p>
<h3 id="negate"><code>negate</code>  ( <code>a</code> &rarr; <code>-a</code> )</h3>
<p>Unary negation of top item.</p>
<h3 id="%2a"><code>*</code>  ( <code>a</code> <code>b</code> &rarr; <code>b*a</code> )</h3>
<p>Multiply top items.</p>
<h3 id="%2a%2a"><code>**</code>  ( <code>b</code><em class="dpar">base</em> <code>e</code><em class="dpar">exponent</em> &rarr; <code>b**e</code> )</h3>
<p>Power of top two items.</p>
<h3 id="%2fmod"><code>/mod</code>  ( <code>x</code><em class="dpar">dividend</em> <code>y</code><em class="dpar">divisor</em> &rarr; <code>q</code><em class="dpar">quotient</em> <code>r</code><em class="dpar">remainder</em> )</h3>
<p>Euclidean division. Remainder and quotient.</p>
<h3 id="%2f"><code>/</code>  ( <code>a</code><em class="dpar">dividend</em> <code>b</code><em class="dpar">divisor</em> &rarr; <code>q</code><em class="dpar">quotient</em> )</h3>
<p>Regular division (results in float).</p>
<h3 id="%3d"><code>=</code>  ( <code>a</code> <code>b</code> &rarr; <code>t</code> )</h3>
<p>Equals, using Javascript <code>==</code> operator.</p>
<h3 id="%3e"><code>&gt;</code>  ( <code>a</code><em class="dpar">number on &ldquo;larger&rdquo; (left) side of expression.</em> <code>b</code><em class="dpar">number on &ldquo;smaller&rdquo; (right) side of expression.</em> &rarr; <code>t</code> )</h3>
<p>Greater than.</p>
<h3 id="nand"><code>nand</code>  ( <code>a</code> <code>b</code> &rarr; <code>t</code> )</h3>
<p>Boolean NAND of two arguments. True if both are false.</p>
<h3 id="%7e"><code>~</code>  ( <code>n</code> &rarr; <code>~n</code> )</h3>
<p>Bitwise NOT of a number.</p>
<h3 id="%26"><code>&amp;</code>  ( <code>a</code> <code>b</code> &rarr; <code>a&amp;b</code> )</h3>
<p>Bitwise AND of two numbers.</p>
<h3 id="%7c"><code>|</code>  ( <code>a</code> <code>b</code> &rarr; <code>a|b</code> )</h3>
<p>Bitwise OR of two numbers.</p>
<h3 id="%5e"><code>^</code>  ( <code>a</code> <code>b</code> &rarr; <code>a^b</code> )</h3>
<p>Bitwise XOR of two numbers.</p>
<h3 id="%3c%3c"><code>&lt;&lt;</code>  ( <code>a</code> <code>b</code> &rarr; <code>a&lt;&lt;b</code> )</h3>
<p>A bit-shifted left by B places. Negative B for shift right.</p>
<h3 id="put"><code>put</code>  ( <code>i</code><em class="dpar">Item to push</em> <code>a</code><em class="dpar">Array to push onto</em> &rarr;  )</h3>
<p>Pushes the item onto the end of the array.</p>
<p><strong>See Also:</strong> <a href="#take"><code>take</code></a></p>
<h3 id="take"><code>take</code>  ( <code>a</code><em class="dpar">Array</em> &rarr; <code>i</code><em class="dpar">Last item of the array</em> )</h3>
<p>Reverse of <a href="#put"><code>put</code></a>, it takes the item out of the array. The array is mutated.</p>
<h3 id="%5ddone%5b"><code>]done[</code>  (  &rarr;  )</h3>
<p>Drops the top item of the return stack, effectively causing everything else outside of the current word to be skipped.</p>
<p>Example:</p>
<pre><code class="language-phoo">
[ foo [ ]done[ bar ] baz ]
// foo and then bar are run, but baz is skipped.
</code></pre>
<h3 id="%5dagain%5b"><code>]again[</code>  (  &rarr;  )</h3>
<p>Sets the return pointer of the top return stack item to -1, effectively causing everything else outside of the current word to be repeated.</p>
<p>Example:</p>
<pre><code class="language-phoo">
[ foo [ ]again[ bar ] baz ]
// runs foo bar foo bar foo bar foo bar ... infintely
</code></pre>
<h3 id="%5dcjump%5b"><code>]cjump[</code>  ( <code>t</code><em class="dpar">truth value to test</em> <code>n</code><em class="dpar">how far to jump if false</em> &rarr;  )</h3>
<p>If the test value <code>t</code> is false, adds <code>n</code> to the top return stack entry&rsquo;s return pointer, effectively skipping that many items.</p>
<p>Example:</p>
<pre><code class="language-phoo">
[ 3 ]cjump[ ] foo bar baz bam
// if ToS is false, skips foo bar baz. bam will always run
</code></pre>
<h3 id="%5d%27%5b"><code>]'[</code>  (  &rarr; <code>a</code> )</h3>
<p>Instead of running the next item on the top return stack entry, pushes it to the stack and crements the return stack pointer.</p>
<p>Example:</p>
<pre><code class="language-phoo">
[ ]'[ drop ] foo bar
// foo will be pushed to the stack and then dropped, rendering it a noop. bar will run.
</code></pre>
<h3 id="%5drun%5b"><code>]run[</code>  ( <code>a</code> &rarr;  )</h3>
<p>Pushes the item to the return stack, so that it will run when the current word finishes.</p>
<p>Example:</p>
<pre><code class="language-phoo">
[ table a b c ] [ ]run[ ]
// if ToS is n, runs nth item of the table.
</code></pre>
<h3 id="%5dthis%5b"><code>]this[</code>  ( <code>a</code> &rarr;  )</h3>
<p>Pushes the top array on the return stack to the work stack, so that the word can reference its caller.</p>
<h3 id="%5b%5d"><code>[]</code>  (  &rarr; <code>a</code> )</h3>
<p>Pushes <code>a</code> new, empty array to the work stack.</p>
<h3 id="concat"><code>concat</code>  ( <code>a</code> <code>b</code> &rarr; <code>ab</code> )</h3>
<p>Concatenates two arrays. non-arrays are treated like one-element arrays.</p>
<h3 id="peek"><code>peek</code>  ( <code>a</code> <code>i</code> &rarr; <code>a[i]</code> )</h3>
<p>Takes the <code>i</code>-th item out of the array <code>a</code>.</p>
<h3 id="poke"><code>poke</code>  ( <code>t</code><em class="dpar">item to poke</em> <code>a</code><em class="dpar">the array to be poked</em> <code>i</code><em class="dpar">index to poke at</em> &rarr; <code>a</code><em class="dpar">the array to be poked</em> )</h3>
<p>Puts the item into the specified index of the array, and leaves the new, mutated array.</p>
<h3 id="%5dsandbox%5b"><code>]sandbox[</code>  ( <code>c</code> &rarr; <code>e</code> )</h3>
<p>Runs the code under a <code>try</code> statement, and pushes the error it threw, or <code>false</code> if no error.</p>
<h3 id="die"><code>die</code>  ( <code>m</code> &rarr;  )</h3>
<p>Throws a <code>PhooError</code> with the message.</p>
<h3 id="%5dgetstack%5b"><code>]getstack[</code>  ( <code>e</code> &rarr; <code>t</code> )</h3>
<p>With a <code>PhooError</code> on the top, gets its Phoo stack trace.</p>
<h3 id="type"><code>type</code>  ( <code>o</code> &rarr; <code>t</code> )</h3>
<p>Gets the type of the object.</p>
<h3 id="compile"><code>compile</code>  ( <code>s</code> &rarr; <code>a</code> )</h3>
<p>Compiles the string, so that it can be run.</p>
<h3 id="time"><code>time</code>  (  &rarr; <code>t</code> )</h3>
<p>Pushes the system time, in milliseconds.</p>
<h3 id="await"><code>await</code>  ( <code>p</code> &rarr; <code>v</code> )</h3>
<p>Awaits a <code>Promise</code> and pushes the resolve value.</p>
<h3 id="get"><code>get</code>  ( <code>o</code><em class="dpar">object</em> <code>k</code><em class="dpar">string key</em> &rarr; <code>v</code><em class="dpar">o.k</em> )</h3>
<p>Object and key, looks up.</p>
<h3 id="set"><code>set</code>  ( <code>v</code><em class="dpar">value to set</em> <code>o</code><em class="dpar">object</em> <code>k</code><em class="dpar">string key</em> &rarr;  )</h3>
<p>Value, object, and key, sets the key.</p>
<h3 id="call"><code>call</code>  ( <code>a</code><em class="dpar">arguments array</em> <code>f</code><em class="dpar">function</em> &rarr; <code>r</code><em class="dpar">return value</em> )</h3>
<p>Calls <code>a</code> function with the arguments.</p>
<p><strong>See Also:</strong> <a href="#new"><code>new</code></a></p>
<h3 id="new"><code>new</code>  ( <code>a</code><em class="dpar">arguments array</em> <code>f</code><em class="dpar">constructor function</em> &rarr; <code>r</code><em class="dpar">new object constructed</em> )</h3>
<p>Same sort as <a href="#call"><code>call</code></a>, but uses Javascript <code>new</code> keyword to construct with a class.</p>
<h3 id="word"><code>word</code>  ( <code>s</code><em class="dpar">string</em> &rarr; <code>w</code><em class="dpar">symbol of that string</em> )</h3>
<p>Converts string to symbol.</p>
<h3 id="name"><code>name</code>  ( <code>w</code><em class="dpar">symbol</em> &rarr; <code>s</code><em class="dpar">string of that symbol</em> )</h3>
<p>Reverse of <a href="#word"><code>word</code></a>, converts symbol to string.</p>
<h3 id="resolve"><code>resolve</code>  ( <code>w</code><em class="dpar">symbol</em> &rarr; <code>d</code><em class="dpar">definition</em> )</h3>
<p>Looks up the definition of the word symbol.</p>
<h3 id="%7b%7d"><code>{}</code>  (  &rarr; <code>a</code> )</h3>
<p>Pushes <code>a</code> new empty object.</p>
<h3 id="self"><code>self</code>  (  &rarr; <code>t</code> )</h3>
<p>Pushes a reference to the current thread.</p>
<h3 id="window"><code>window</code>  (  &rarr; <code>t</code> )</h3>
<p>Pushes a reference to the global Javascript object (<code>globalThis</code>). Called &ldquo;window&rdquo; because that is its name in the browser which is what Phoo was designed for.</p>
<h3 id="%5ddefine%5b"><code>]define[</code>  ( <code>n</code><em class="dpar">symbol name</em> <code>d</code><em class="dpar">definition</em> &rarr;  )</h3>
<p>Writes a new definition to the top scope using the name and definition on the stack.</p>
<h3 id="%5ddefine%2dmacro%5b"><code>]define-macro[</code>  ( <code>n</code><em class="dpar">symbol name</em> <code>d</code><em class="dpar">definition</em> &rarr;  )</h3>
<p>Like <a href="#%5ddefine%5b"><code>]define[</code></a> but defines a macro.</p>
<h3 id="%5dforget%5b"><code>]forget[</code>  ( <code>n</code><em class="dpar">symbol name</em> &rarr;  )</h3>
<p>Erases the definition of a word, reverting back to the old one if there was one.</p>
<h3 id="to"><code>to</code> <em class="shadowed"><code>name</code></em> <em class="shadowed"><code>def</code></em> (  &rarr;  )</h3>
<p>Wrapper for <a href="#%5ddefine%5b"><code>]define[</code></a>.</p>
<h3 id="macro"><code>macro</code> <em class="shadowed"><code>name</code></em> <em class="shadowed"><code>def</code></em> (  &rarr;  )</h3>
<p>Wrapper for <a href="#%5ddefine%2dmacro%5b"><code>]define-macro[</code></a>.</p>
<h3 id="forget"><code>forget</code> <em class="shadowed"><code>name</code></em> (  &rarr;  )</h3>
<p>Wrapper for <a href="#%5dforget%5b"><code>]forget[</code></a>.</p>
<h3 id="%5dimport%5b"><code>]import[</code>  ( <code>n</code><em class="dpar">name of the module</em> <code>r</code><em class="dpar">boolean, force-reload the module</em> &rarr;  )</h3>
<p>Imports the module, force-reloading if the top is true (ignores cache).</p>
<h3 id="promise"><code>promise</code>  (  &rarr; <code>p</code><em class="dpar">the promise</em> <code>x</code><em class="dpar">reject callback</em> <code>r</code><em class="dpar">resolve callback</em> )</h3>
<p>Pushes the pieces to a new promise.</p>
<h3 id="functionize"><code>functionize</code>  ( <code>c</code> &rarr; <code>f</code> )</h3>
<p>Turns the code into a function, that will run the code in a subthread.</p>
<hr />
<p><a href="/docs/index.html">back to index</a></p>
<p>docs@7d684dd9edbe2d8bd99e1d3fd98425ed3f3ce121</p></body></html>